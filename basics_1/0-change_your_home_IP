#!/usr/bin/env bash
# This script modifies /etc/hosts to map localhost to 127.0.0.2 and facebook.com to 8.8.8.8

HOSTS_FILE="/etc/hosts"

# Vérifie si le script est exécuté avec les privilèges root
if [[ $EUID -ne 0 ]]; then
  echo "❌ Please run this script as root (use sudo)"
  exit 1
fi

# Remplacer l’entrée localhost par 127.0.0.2
# On commente d'abord les anciennes lignes pour garder une trace
sed -i.bak '/127.0.0.1\s\+localhost/ s/^/# OLD: /' "$HOSTS_FILE"
echo "127.0.0.2 localhost" >> "$HOSTS_FILE"

# Ajouter ou remplacer l’entrée pour facebook.com
# Supprime les anciennes entrées facebook.com si présentes
sed -i '/facebook.com/d' "$HOSTS_FILE"
echo "8.8.8.8 facebook.com" >> "$HOSTS_FILE"

echo "✅ Hosts file updated. localhost -> 127.0.0.2, facebook.com -> 8.8.8.8"
